# Data Issue: "flat" vs "monthly" Pricing Model

## Summary

Found **190 records across 26 publications** using `pricingModel: "flat"` that need review.

## Issue Breakdown

### ✅ CORRECT Usage: Events (89 records)
**These should KEEP `pricingModel: "flat"`**

- **Events: 63 standard records**
- **Events Hub Pricing: 26 records**

**Why "flat" is correct for events:**
- Events have a `frequency` field (annual, monthly, quarterly, etc.)
- The `"flat"` pricing model is designed to work with frequency
- Pricing represents: **flat rate per occurrence**
- System calculates monthly revenue as: `(flatRate × occurrences per month) / 30 days`

**Example:**
```json
{
  "event": {
    "name": "Community Events",
    "frequency": "monthly",
    "advertisingOpportunities": [{
      "level": "title",
      "pricing": {
        "pricingModel": "flat",  // ✅ CORRECT
        "flatRate": 5000         // $5,000 per event occurrence
      }
    }]
  }
}
```

### ❌ INCORRECT Usage: Website Ads (99 records)
**These should CHANGE to `pricingModel: "monthly"`**

- **Website: 43 standard records**
- **Website Hub Pricing: 56 records**

**Why "flat" is wrong for websites:**
- Website ads are ongoing monthly recurring placements
- They don't have a frequency field (frequency doesn't apply)
- Should display as "$3,000/month" not "$3,000/occurrence"
- The `"monthly"` pricing model is designed for this

**Example of current (wrong) data:**
```json
{
  "website": {
    "advertisingOpportunities": [{
      "name": "Digital Ads Package",
      "pricing": {
        "pricingModel": "flat",  // ❌ WRONG - should be "monthly"
        "flatRate": 3000          // Should display as "$3,000/month"
      }
    }]
  }
}
```

**What it should be:**
```json
{
  "website": {
    "advertisingOpportunities": [{
      "name": "Digital Ads Package",
      "pricing": {
        "pricingModel": "monthly",  // ✅ CORRECT
        "flatRate": 3000             // Displays as "$3,000/month"
      }
    }]
  }
}
```

### ⚠️ NEEDS REVIEW: Radio (2 records)
**Need to check if radio shows have frequency field**

- **Radio: 1 standard record**
- **Radio Hub Pricing: 1 record**

If radio shows have a frequency field (weekly, daily), then "flat" is correct.
If not, should change to appropriate pricing model based on context.

## Affected Publications

26 out of 32 publications (81%) have this issue:

1. Chicago Sun-Times (ID: 1035)
2. La Raza Chicago (ID: 1038)
3. N'DIGO (ID: 1043)
4. Free Spirit Media (ID: 1044)
5. [21 more publications...]

## Technical Details

### From `pricingCalculations.ts`:

```typescript
switch (pricingModel) {
  case 'monthly':
  case 'flat':
    // For flat rates with frequency (e.g., events), flatRate = price per occurrence
    // Monthly revenue = flatRate * occurrences per month
    if (channelFrequency) {
      const occurrencesPerMonth = inferOccurrencesFromFrequency(channelFrequency);
      return (flatRate * occurrencesPerMonth) / DAYS_PER_MONTH;
    }
    // Default: assume flatRate is already monthly
    return flatRate / DAYS_PER_MONTH;
```

### Display Format (from `formatPricingModel`):
- `"flat"` → displays as "/occurrence"
- `"monthly"` → displays as "/month"

## Recommendation

### Immediate Action Required:
**Fix 99 website advertising records** by changing:
- FROM: `pricingModel: "flat"`
- TO: `pricingModel: "monthly"`

This affects both standard pricing and hub pricing across 99 records.

### No Action Needed:
**89 event records** are using "flat" correctly and should remain unchanged.

### Follow-up:
**Review 2 radio records** to determine correct pricing model based on whether they have frequency.

## Next Steps

1. **Review the detailed report:**
   - `reports/flat-pricing-analysis-2025-11-18T17-08-12.691Z.json`

2. **Create a migration script** to:
   - Change website ads from "flat" to "monthly"
   - Skip events (they're correct)
   - Handle both standard pricing and hub pricing arrays

3. **Test the changes** in a development/staging environment

4. **Run the migration** on production database

## Impact

### User-Facing Impact:
- Website ads will correctly display "$3,000/month" instead of "$3,000/occurrence"
- Revenue calculations will remain the same (code handles both identically when no frequency is present)
- Package builder will show correct pricing labels

### No Breaking Changes:
The underlying calculation logic already handles both "flat" and "monthly" identically when there's no frequency field, so this is primarily a display/labeling fix.

## Generated By

Script: `scripts/countFlatPricingModel.ts`  
Date: 2025-11-18  
Command: `NODE_OPTIONS="--require dotenv/config" npx tsx scripts/countFlatPricingModel.ts`

